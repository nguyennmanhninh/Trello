<div class="departments-container">
  
  <!-- Header -->
  <div class="page-header">
    <h1 class="page-title">
      <span class="icon">üè¢</span>
      Qu·∫£n l√Ω Khoa
    </h1>
  </div>

  <!-- Success/Error Messages -->
  <div class="alert alert-success" *ngIf="successMessage">
    <span class="alert-icon">‚úì</span>
    {{ successMessage }}
  </div>
  
  <div class="alert alert-error" *ngIf="errorMessage">
    <span class="alert-icon">‚úï</span>
    {{ errorMessage }}
  </div>

  <!-- Toolbar -->
  <div class="toolbar">
    <div class="search-box">
      <input 
        type="text" 
        class="search-input" 
        placeholder="T√¨m ki·∫øm theo m√£ khoa ho·∫∑c t√™n khoa..."
        [(ngModel)]="searchString"
        (keyup.enter)="search()"
      />
      <button class="btn btn-icon" (click)="search()" *ngIf="!searchString">
        <span class="icon">üîç</span>
      </button>
      <button class="btn btn-icon" (click)="clearSearch()" *ngIf="searchString">
        <span class="icon">‚úï</span>
      </button>
    </div>
    
    <button class="btn btn-primary" (click)="openAddModal()">
      <span class="icon">+</span>
      Th√™m khoa m·ªõi
    </button>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
  </div>

  <!-- Departments Table -->
  <div class="table-container" *ngIf="!isLoading">
    <table class="data-table">
      <thead>
        <tr>
          <th>STT</th>
          <th>M√£ khoa (ID)</th>
          <th>M√£ khoa (Code)</th>
          <th>T√™n khoa</th>
          <th class="text-center">Thao t√°c</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let dept of departments; let i = index">
          <td>{{ i + 1 }}</td>
          <td><strong>{{ dept.departmentId }}</strong></td>
          <td><span class="badge">{{ dept.departmentCode }}</span></td>
          <td>{{ dept.departmentName }}</td>
          <td class="text-center">
            <div class="action-buttons">
              <button class="btn-action btn-edit" (click)="openEditModal(dept)" title="Ch·ªânh s·ª≠a">
                <span class="icon">‚úèÔ∏è</span>
              </button>
              <button class="btn-action btn-delete" (click)="openDeleteConfirm(dept)" title="X√≥a">
                <span class="icon">üóëÔ∏è</span>
              </button>
            </div>
          </td>
        </tr>
        <tr *ngIf="departments.length === 0">
          <td colspan="5" class="text-center empty-state">
            <div class="empty-icon">üìÇ</div>
            <p>Kh√¥ng c√≥ d·ªØ li·ªáu</p>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Add/Edit Modal -->
  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">{{ isEditMode ? 'C·∫≠p nh·∫≠t khoa' : 'Th√™m khoa m·ªõi' }}</h2>
        <button class="modal-close" (click)="closeModal()">‚úï</button>
      </div>
      
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">
            M√£ khoa (ID) <span class="required">*</span>
          </label>
          <input 
            type="text" 
            class="form-input"
            [class.error]="validationErrors.departmentId"
            [(ngModel)]="currentDepartment.departmentId"
            [disabled]="isEditMode"
            placeholder="V√≠ d·ª•: DEPT001"
            maxlength="10"
          />
          <small class="error-text" *ngIf="validationErrors.departmentId">
            {{ validationErrors.departmentId }}
          </small>
        </div>

        <div class="form-group">
          <label class="form-label">
            M√£ khoa (Code) <span class="required">*</span>
          </label>
          <input 
            type="text" 
            class="form-input"
            [class.error]="validationErrors.departmentCode"
            [(ngModel)]="currentDepartment.departmentCode"
            placeholder="V√≠ d·ª•: CNTT"
            maxlength="20"
          />
          <small class="error-text" *ngIf="validationErrors.departmentCode">
            {{ validationErrors.departmentCode }}
          </small>
        </div>

        <div class="form-group">
          <label class="form-label">
            T√™n khoa <span class="required">*</span>
          </label>
          <input 
            type="text" 
            class="form-input"
            [class.error]="validationErrors.departmentName"
            [(ngModel)]="currentDepartment.departmentName"
            placeholder="V√≠ d·ª•: C√¥ng ngh·ªá th√¥ng tin"
            maxlength="100"
          />
          <small class="error-text" *ngIf="validationErrors.departmentName">
            {{ validationErrors.departmentName }}
          </small>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal()">H·ªßy</button>
        <button class="btn btn-primary" (click)="saveDepartment()">
          {{ isEditMode ? 'C·∫≠p nh·∫≠t' : 'Th√™m m·ªõi' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal-overlay" *ngIf="showDeleteConfirm" (click)="closeDeleteConfirm()">
    <div class="modal-content modal-small" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">X√°c nh·∫≠n x√≥a</h2>
        <button class="modal-close" (click)="closeDeleteConfirm()">‚úï</button>
      </div>
      
      <div class="modal-body">
        <div class="confirm-message">
          <div class="confirm-icon">‚ö†Ô∏è</div>
          <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a khoa <strong>{{ departmentToDelete?.departmentName }}</strong>?</p>
          <p class="text-warning">H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c!</p>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeDeleteConfirm()">H·ªßy</button>
        <button class="btn btn-danger" (click)="confirmDelete()">X√≥a</button>
      </div>
    </div>
  </div>

</div>
